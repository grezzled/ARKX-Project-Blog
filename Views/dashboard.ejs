<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog Dashboard</title>
</head>

<body>
    <header>
        <h1>Blog Dashboard</h1>
        <button id="logout-button">Logout</button>
    </header>
    <main>
        <section id="create-post">
            <h2>Create a New Post</h2>
            <form id="post-form">
                <label for="title">Title:</label>
                <input type="text" id="title" name="title" required>
                <label for="content">Content:</label>
                <textarea id="content" name="content" required></textarea>
                <button type="submit">Create Post</button>
            </form>
        </section>

        <!-- List of existing blog posts -->
        <section id="posts">
            <h2>Your Blog Posts</h2>
            <ul id="post-list">
                <!-- Existing posts will be displayed here -->
            </ul>
        </section>
    </main>

    <script>

        document.addEventListener('DOMContentLoaded', function () {
            
            const postForm = document.getElementById('post-form');
            postForm.addEventListener('submit', function (e) {
                e.preventDefault();
                const title = document.getElementById('title').value;
                const content = document.getElementById('content').value;

                // Send a POST request to create a new blog post
                fetch('/blog/create', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ title, content })
                })
                    .then(response => response.json())
                    .catch(error => {
                        console.error('Error creating post:', error);
                    });
            });

            // Handle logout
            const logoutButton = document.getElementById('logout-button');
            logoutButton.addEventListener('click', function () {
                fetch('/logout', {
                    method: 'POST',
                })
                    .then(response => response.json())
                    .then(data => {
                        window.location.href = '/login';
                    })
                    .catch(error => {
                        console.error('Logout error:', error);
                    });
            });
        });

    </script>
</body>

</html>